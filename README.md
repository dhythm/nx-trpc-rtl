# Nx + tRPC + RTL

<a alt="Nx logo" href="https://nx.dev" target="_blank" rel="noreferrer"><img src="https://raw.githubusercontent.com/nrwl/nx/master/images/nx-logo.png" width="45"></a>

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

## Installation

Create the repo by following command.

```sh
npx create-nx-workspace@latest

✔ Choose what to create                 · integrated
✔ What to create in the new workspace   · react-monorepo
✔ Repository name                       · nx-trpc-rtl
✔ Application name                      · admin
✔ Bundler to be used to build the application · webpack
✔ Default stylesheet format             · @emotion/styled
✔ Enable distributed caching to make your CI faster · No
```

Install tRPC core libraries

```sh
npm install @trpc/server @trpc/client
npm install @trpc/react-query @tanstack/react-query zod
```

Create Nx libraries for tRPC client and server.

```sh
npx nx g @nrwl/workspace:library --importPath=@trpc-client trpc-client
npx nx g @nrwl/workspace:library --importPath=@trpc-server trpc-server
```

Install server-side libraries.

```sh
npm install fastify @fastify/websocket @fastify/cors
```

Create BFF app.

```sh
npm install --save-dev @nrwl/node
npx nx g @nrwl/node:application bff

✔ Which framework do you want to use? · fastify

rm -fr apps/bff-e2e
```

Install for running app.

```sh
npm install --save-dev npm-run-all
```

Install for testing.

```sh
npm install --save-dev 'whatwg-fetch'
npm install --save-dev @testing-library/jest-dom
npm install --save-dev msw
```

Run tests.

```sh
node 'node_modules/.bin/jest' 'apps/admin' -c 'apps/admin/jest.config.ts'
node 'node_modules/.bin/jest' 'apps/admin/src/app/hooks/__tests__/useUsers.spec.tsx' -c 'apps/admin/jest.config.ts' -t '...'
```

## Development server

Run `nx serve admin` for a dev server. Navigate to http://localhost:4200/. The app will automatically reload if you change any of the source files.

## Understand this workspace

Run `nx graph` to see a diagram of the dependencies of the projects.

## Remote caching

Run `npx nx connect-to-nx-cloud` to enable [remote caching](https://nx.app) and make CI faster.

## Further help

Visit the [Nx Documentation](https://nx.dev) to learn more.
